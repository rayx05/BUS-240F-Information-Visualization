library(tidyverse) 
library(ggplot2)  
library(ggridges)


library(RColorBrewer)


display.brewer.all(7, type="seq", colorblindFriendly = "True")
display.brewer.all(7, type="div", colorblindFriendly = "True")
display.brewer.all(7, type="qual", colorblindFriendly = "True")
display.brewer.pal(5, "PuOr")    
display.brewer.pal(5, "Reds")    
display.brewer.pal(5, "Accent")  

#data frame 
df = read.csv("~/Desktop/BUS 240F/Team Project/Report 2/NBA_Database_Cleaned.csv", header=TRUE)
print (df)


#compute field goal percentage 
#step 1: compute the total field goals of each season 
df$Total.Field.Goals = round (df$Field.Goals.Per.Game * df$Games, digits = 0)
Total.Field.Goals = aggregate(Total.Field.Goals ~ Player, df, sum)
Sorted.Total.field.Goals = Total.Field.Goals[order(Total.Field.Goals$Total.Field.Goals, decreasing = TRUE), ]
Sorted.Total.field.Goals #this result shows players with the most field goals 
top.ten.tfg = head(Sorted.Total.field.Goals, 10) #top ten players with the most field goals scored
top.ten.tfg 
viz = ggplot(top.ten.tfg, aes(x = reorder(Player, -Total.Field.Goals), y = Total.Field.Goals)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Top Ten Players by Total Field Goals",
       x = "Player",
       y = "Total Field Goals") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
viz

#step 2: compute the total field goal attempts of each season 
df$Total.Field.Goal.Attempts = round (df$Field.Goal.Attempts.Per.Game * df$Games, digits = 0)

Total.Field.Goal.Attempts = aggregate(Total.Field.Goal.Attempts ~ Player, df, sum)
Total.Field.Goal.Attempts
Sorted.Total.Field.Goal.Attempts = Total.Field.Goal.Attempts[order(Total.Field.Goal.Attempts$Total.Field.Goal.Attempts, decreasing = TRUE),]
Sorted.Total.Field.Goal.Attempts


#step 3: compute accuracy 
df$accuracy = df$Total.Field.Goals / df$Total.Field.Goal.Attempts
accuracy = aggregate (accuracy ~ Player, df, mean)
accuracy
sorted.accuracy = accuracy [order(accuracy$accuracy, decreasing = TRUE),]
sorted.accuracy
top.ten.accuracy = head(sorted.accuracy, 10)
top.ten.accuracy
vis = ggplot(top.ten.accuracy, aes(x = reorder(Player, -accuracy), y = accuracy)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Top Ten Players by Field Goal Accuracy",
       x = "Player",
       y = "Accuracy") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
vis
